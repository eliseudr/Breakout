<html>

    <canvas id="breakout" width="900" height="450"></canvas>

    <script>

        var canvas;
        var canvasContext;

        //Barra Controlavel
        const LarguraBarra = 180;
        const AlturaBarra = 10;

        //Barras inimigas
        var BarrinhaAltura = 15;
        var BarrinhaLargura =  40;

        //Quantidade de pixels que sera movidos
        var velocidadeX = 7;
        var velocidadeY = 7;

        //Posições iniciais da bola
        var BolaX = 450;
        var BolaY = 350;

        //Posições Iniciais da Barra Jogavel
        var PosicaoX = 360;
        var PosicaoY = 430;

        //Para carregar o conteudo apenas apos carregar toda a pagina.
         window.onload = function(){
            
            canvas = document.getElementById("breakout");
            canvasContext = canvas.getContext("2d");

            setInterval(function (){
                        Visual();
                        Movimento();
                        }, 10);
            
        }    

        function Movimento(){

            BolaX = BolaX + velocidadeX;
            BolaY = BolaY + velocidadeY;

            //Limitando as paredes do canvas, Movimento de rebatimento!
            if(BolaX >= canvas.width || BolaX <= 0){
                velocidadeX = -velocidadeX;
            }else if(BolaY < 0){
                    velocidadeY = -velocidadeY;
                }
            
            //Calcula se a bola acerto a Barra jogavel!!
            //Os numeros ao lado das posições sao para correções do hitbox da barra.
            // ---POSIÇÃO INICIAL --------POSIÇÃO FINAL ------------ ESPESSURA DA BARRA.
            if( BolaX >= PosicaoX-3 && BolaX <= PosicaoX+LarguraBarra+3 && BolaY > PosicaoY-10){
                velocidadeY = -velocidadeY;
                //velocidadeX++;
            }else{
                ResetaBola();
            }

        }

        function ResetaBola(){
            if(BolaY > canvas.height){
                BolaX = 450;
                BolaY = 350;
            }
        }

        function Visual(){
            
            canvasContext.fillStyle = "black";
            canvasContext.fillRect(0, 0, canvas.width, canvas.height);

            //Cria a barra jogavel
            canvasContext.fillStyle = "white";
            canvasContext.fillRect(PosicaoX, PosicaoY, LarguraBarra, AlturaBarra);

            //Criação da bola
            canvasContext.fillStyle = "red";
            canvasContext.beginPath();
            canvasContext.arc(BolaX, BolaY, 7, 0, 2 * Math.PI, true);
            canvasContext.fill();//Preenche a bola
            
            BarrasInimigas();

        }

        function BarrasInimigas(){

            for(var x = 5; x < canvas.width ; x += 50){
                for( var y = 10 ; y < 250 ; y += 20){
                canvasContext.fillStyle = "pink";
                canvasContext.fillRect(x, y, BarrinhaLargura, BarrinhaAltura); 
                }
            }
        } 
        
       

    </script>


</html>